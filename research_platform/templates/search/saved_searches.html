{% extends 'base.html' %}
{% block title %}Saved Searches - Orravyn Research{% endblock %}

{% block extra_css %}
<style>
    .page-header {
        margin-bottom: 2rem;
    }

    .page-header h1 {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--text-primary);
    }

    .search-item {
        background: transparent;
        border: none;
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        padding: 1.25rem 0;
        transition: all 0.3s ease;
        position: relative;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .search-item::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        width: 3px;
        height: 100%;
        background: var(--primary-gradient);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .search-item:hover {
        transform: translateX(8px);
    }

    .search-item:hover::before {
        opacity: 1;
    }

    .search-info h3 {
        font-size: 1.05rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.3rem;
    }

    .search-info h3 a {
        color: var(--text-primary);
        text-decoration: none;
        transition: color 0.25s ease;
    }

    .search-info h3 a:hover {
        color: var(--accent-color);
    }

    .search-query {
        font-size: 0.88rem;
        color: var(--text-secondary);
        font-family: 'Courier New', monospace;
        background: rgba(0, 0, 0, 0.03);
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        display: inline-block;
        margin-top: 0.3rem;
    }

    .search-meta {
        font-size: 0.78rem;
        color: var(--text-secondary);
        margin-top: 0.4rem;
    }

    .delete-btn {
        padding: 0.4rem 0.8rem;
        background: transparent;
        border: 1.5px solid #dc2626;
        color: #dc2626;
        border-radius: 8px;
        font-size: 0.8rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.25s ease;
    }

    .delete-btn:hover {
        background: #dc2626;
        color: #fff;
    }

    .empty-state {
        text-align: center;
        padding: 3rem 1.5rem;
        color: var(--text-secondary);
    }

    .empty-state i {
        font-size: 2.5rem;
        opacity: 0.2;
        margin-bottom: 1rem;
        display: block;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Saved Searches</h1>
</div>

<div class="searches-list">
    {% for search in saved_searches %}
    <div class="search-item">
        <div class="search-info">
            <h3>
                <a href="{% url 'search:search' %}?q={{ search.query }}&category={{ search.filters.category }}&author={{ search.filters.author }}&year_from={{ search.filters.year_from }}&year_to={{ search.filters.year_to }}&citation_min={{ search.filters.citation_min }}&citation_max={{ search.filters.citation_max }}&boolean={{ search.filters.boolean }}">
                    {{ search.name }}
                </a>
            </h3>
            <div class="search-query">{{ search.query|default:"All papers" }}</div>
            <div class="search-meta">
                <i class="fas fa-clock"></i> Saved {{ search.created_at|timesince }} ago
            </div>
        </div>
        <div>
            <form method="post" action="{% url 'search:delete_saved_search' search.pk %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="delete-btn" onclick="return confirm('Delete this saved search?')">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </form>
        </div>
    </div>
    {% empty %}
    <div class="empty-state">
        <i class="fas fa-bookmark"></i>
        <p>You haven't saved any searches yet.</p>
        <a href="{% url 'search:search' %}" class="feature-btn">Start Searching</a>
    </div>
    {% endfor %}
</div>

{% if is_paginated %}
<nav aria-label="Saved searches pagination" style="margin-top: 2rem;">
    <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
        </li>
        {% endif %}
        {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
        <li class="page-item active"><span class="page-link">{{ num }}</span></li>
        {% else %}
        <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
        {% endif %}
        {% endfor %}
        {% if page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
        </li>
        {% endif %}
    </ul>
</nav>
{% endif %}
{% endblock %}
